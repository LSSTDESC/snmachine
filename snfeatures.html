

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>snfeatures &mdash; snmachine 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tsne_plot" href="tsne_plot.html" />
    <link rel="prev" title="sndata" href="sndata.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> snmachine
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="pmodels.html">parametric_models</a></li>
<li class="toctree-l1"><a class="reference internal" href="snclassifier.html">snclassifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="sndata.html">sndata</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">snfeatures</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsne_plot.html">tsne_plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel.html">Running on Clusters / in Parallel</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">snmachine</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>snfeatures</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/snfeatures.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-snmachine.snfeatures">
<span id="snfeatures"></span><h1>snfeatures<a class="headerlink" href="#module-snmachine.snfeatures" title="Permalink to this headline">¶</a></h1>
<p>Module for feature extraction on supernova light curves.</p>
<dl class="class">
<dt id="snmachine.snfeatures.Features">
<em class="property">class </em><code class="descclassname">snmachine.snfeatures.</code><code class="descname">Features</code><a class="reference internal" href="_modules/snmachine/snfeatures.html#Features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.Features" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class to define basic functionality for extracting features from supernova datasets. Users are not
restricted to inheriting from this class, but any Features class must contain the functions extract_features
and fit_sn.</p>
<dl class="method">
<dt id="snmachine.snfeatures.Features.convert_astropy_array">
<code class="descname">convert_astropy_array</code><span class="sig-paren">(</span><em>tab</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#Features.convert_astropy_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.Features.convert_astropy_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to convert an astropy table (floats only) into a numpy array.</p>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.Features.goodness_of_fit">
<code class="descname">goodness_of_fit</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#Features.goodness_of_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.Features.goodness_of_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Test (for any feature set) how well the reconstruction from the features fits each of the objects in the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>d</strong> (<a class="reference internal" href="sndata.html#snmachine.sndata.Dataset" title="snmachine.sndata.Dataset"><em>Dataset</em></a>) – Dataset object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Table with the reduced Chi2 for each object</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">astropy.table.Table</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.Features.posterior_predictor">
<code class="descname">posterior_predictor</code><span class="sig-paren">(</span><em>lc</em>, <em>nparams</em>, <em>chi2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#Features.posterior_predictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.Features.posterior_predictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes posterior predictive p-value to see if the model fits sufficient well.
<strong>*UNTESTED*</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lc</strong> (<em>astropy.table.Table</em>) – Light curve</li>
<li><strong>nparams</strong> (<em>int</em>) – The number of parameters in the model. For the wavelets, this will be the number of PCA coefficients. For the parametric
models, this will be the number parameters per model multiplied by the number of filters. For the template models, this is simply the number
of parameters in the model.</li>
<li><strong>chi2</strong> (<em>array-like</em>) – An array of chi2 values for each set of parameter space in the parameter samples. This is easy to obtain as -2*loglikelihood output
from a multinest or mcmc chain. For features such as the wavelets, this will have to be separately calculated by drawing thousands of curves
consistent with the coefficients and their errors and then computing the chi2.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The posterior predictive p-value. If this number is too close to 0 or 1 it implies the model is a poor fit.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="snmachine.snfeatures.ParametricFeatures">
<em class="property">class </em><code class="descclassname">snmachine.snfeatures.</code><code class="descname">ParametricFeatures</code><span class="sig-paren">(</span><em>model_choice</em>, <em>sampler='leastsq'</em>, <em>limits=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#ParametricFeatures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.ParametricFeatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a few options of generalised, parametric models to the data.</p>
<dl class="method">
<dt id="snmachine.snfeatures.ParametricFeatures.extract_features">
<code class="descname">extract_features</code><span class="sig-paren">(</span><em>d</em>, <em>chain_directory='chains'</em>, <em>save_output=True</em>, <em>n_attempts=20</em>, <em>nprocesses=1</em>, <em>n_walkers=100</em>, <em>n_steps=500</em>, <em>walker_spread=0.1</em>, <em>burn=50</em>, <em>nlp=1000</em>, <em>starting_point=None</em>, <em>convert_to_binary=True</em>, <em>n_iter=0</em>, <em>restart=False</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#ParametricFeatures.extract_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.ParametricFeatures.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit parametric models and return best-fitting parameters as features.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>d</strong> (<em>Dataset object</em>) – Dataset</li>
<li><strong>chain_directory</strong> (<em>str</em>) – Where to save the chains</li>
<li><strong>save_output</strong> (<em>bool</em>) – Whether or not to save the intermediate output (if Bayesian inference is used instead of least squares)</li>
<li><strong>n_attempts</strong> (<em>int</em>) – Allow the minimiser to start in new random locations if the fit is bad. Put n_attempts=1 to fit only once
with the default starting position.</li>
<li><strong>nprocesses</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of processors to use for parallelisation (shared memory only)</li>
<li><strong>n_walkers</strong> (<em>int</em>) – emcee parameter - number of walkers to use</li>
<li><strong>n_steps</strong> (<em>int</em>) – emcee parameter - total number of steps</li>
<li><strong>walker_spread</strong> (<em>float</em>) – emcee parameter - standard deviation of distribution of starting points of walkers</li>
<li><strong>burn</strong> (<em>int</em>) – emcee parameter - length of burn-in</li>
<li><strong>nlp</strong> (<em>int</em>) – multinest parameter - number of live points</li>
<li><strong>starting_point</strong> (<em>None</em><em> or </em><em>array-like</em>) – Starting points of parameters for leastsq or emcee</li>
<li><strong>convert_to_binary</strong> (<em>bool</em>) – multinest parameter - whether or not to convert ascii output files to binary</li>
<li><strong>n_iter</strong> (<em>int</em>) – leastsq parameter - number of iterations to avoid local minima</li>
<li><strong>restart</strong> (<em>bool</em>) – Whether or not t restart from existing multinest chains</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Best-fitting parameters</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.ParametricFeatures.fit_sn">
<code class="descname">fit_sn</code><span class="sig-paren">(</span><em>lc</em>, <em>features</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#ParametricFeatures.fit_sn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.ParametricFeatures.fit_sn" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the chosen parametric model to a given light curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lc</strong> (<em>astropy.table.Table</em>) – Light curve</li>
<li><strong>features</strong> (<em>astropy.table.Table</em>) – Model parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fitted light curve</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.ParametricFeatures.lnprob_emcee">
<code class="descname">lnprob_emcee</code><span class="sig-paren">(</span><em>params</em>, <em>x</em>, <em>y</em>, <em>yerr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#ParametricFeatures.lnprob_emcee"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.ParametricFeatures.lnprob_emcee" title="Permalink to this definition">¶</a></dt>
<dd><p>Likelihood function for emcee</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>params</strong> – </li>
<li><strong>x</strong> – </li>
<li><strong>y</strong> – </li>
<li><strong>yerr</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.ParametricFeatures.run_emcee">
<code class="descname">run_emcee</code><span class="sig-paren">(</span><em>d</em>, <em>obj</em>, <em>save_output</em>, <em>chain_directory</em>, <em>n_walkers</em>, <em>n_steps</em>, <em>walker_spread</em>, <em>burn</em>, <em>starting_point</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#ParametricFeatures.run_emcee"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.ParametricFeatures.run_emcee" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs emcee on all the filter bands of a given light curve, fitting the model to each one and extracting the best fitting parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>d</strong> (<em>Dataset object</em>) – Dataset</li>
<li><strong>obj</strong> (<em>str</em>) – Object name</li>
<li><strong>save_output</strong> (<em>bool</em>) – Whether or not to save the intermediate output</li>
<li><strong>chain_directory</strong> (<em>str</em>) – Where to save the chains</li>
<li><strong>n_walkers</strong> (<em>int</em>) – emcee parameter - number of walkers to use</li>
<li><strong>n_steps</strong> (<em>int</em>) – emcee parameter - total number of steps</li>
<li><strong>walker_spread</strong> (<em>float</em>) – emcee parameter - standard deviation of distribution of starting points of walkers</li>
<li><strong>burn</strong> (<em>int</em>) – emcee parameter - length of burn-in</li>
<li><strong>starting_point</strong> (<em>None</em><em> or </em><em>array-like</em>) – Starting points of parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Best fitting parameters (at the maximum posterior)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="snmachine.snfeatures.TemplateFeatures">
<em class="property">class </em><code class="descclassname">snmachine.snfeatures.</code><code class="descname">TemplateFeatures</code><span class="sig-paren">(</span><em>model=['Ia'], sampler='leastsq', lsst_bands=False, lsst_dir='../lsst_bands/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#TemplateFeatures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.TemplateFeatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls sncosmo to fit a variety of templates to the data. The number of features will depend on the templates
chosen (e.g. salt2, nugent2p etc.)</p>
<dl class="method">
<dt id="snmachine.snfeatures.TemplateFeatures.extract_features">
<code class="descname">extract_features</code><span class="sig-paren">(</span><em>d</em>, <em>save_chains=False</em>, <em>chain_directory='chains'</em>, <em>use_redshift=False</em>, <em>nprocesses=1</em>, <em>restart=False</em>, <em>seed=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#TemplateFeatures.extract_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.TemplateFeatures.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract template features for a dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>d</strong> (<em>Dataset object</em>) – Dataset</li>
<li><strong>save_chains</strong> (<em>bool</em>) – Whether or not to save the intermediate output (if Bayesian inference is used instead of least squares)</li>
<li><strong>chain_directory</strong> (<em>str</em>) – Where to save the chains</li>
<li><strong>use_redshift</strong> (<em>bool</em>) – Whether or not to use provided redshift when fitting objects</li>
<li><strong>nprocesses</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of processors to use for parallelisation (shared memory only)</li>
<li><strong>restart</strong> (<em>bool</em>) – Whether or not to restart from multinest chains</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Table of fitted model parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.TemplateFeatures.fit_sn">
<code class="descname">fit_sn</code><span class="sig-paren">(</span><em>lc</em>, <em>features</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#TemplateFeatures.fit_sn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.TemplateFeatures.fit_sn" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the chosen template model to a given light curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lc</strong> (<em>astropy.table.Table</em>) – Light curve</li>
<li><strong>features</strong> (<em>astropy.table.Table</em>) – Model parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fitted light curve</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.TemplateFeatures.registerBands">
<code class="descname">registerBands</code><span class="sig-paren">(</span><em>dirname</em>, <em>prefix=None</em>, <em>suffix=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#TemplateFeatures.registerBands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.TemplateFeatures.registerBands" title="Permalink to this definition">¶</a></dt>
<dd><p>Register LSST bandpasses with sncosmo.
Courtesy of Rahul Biswas</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="snmachine.snfeatures.WaveletFeatures">
<em class="property">class </em><code class="descclassname">snmachine.snfeatures.</code><code class="descname">WaveletFeatures</code><span class="sig-paren">(</span><em>wavelet='sym2'</em>, <em>ngp=100</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses wavelets to decompose the data and then reduces dimensionality of the feature space using PCA.</p>
<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.GP">
<code class="descname">GP</code><span class="sig-paren">(</span><em>obj, d, ngp=200, xmin=0, xmax=170, initheta=[500, 20], gpalgo='george'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.GP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.GP" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a Gaussian process curve at specific evenly spaced points along a light curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obj</strong> (<em>str</em>) – Object name</li>
<li><strong>d</strong> (<em>Dataset object</em>) – Dataset</li>
<li><strong>/ int</strong><strong>, </strong><strong>optional</strong> (<em>ngp</em>) – Number of points to evaluate Gaussian Process at</li>
<li><strong>xmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimim time to evaluate at</li>
<li><strong>xmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum time to evaluate at</li>
<li><strong>initheta</strong> (<em>list-like</em><em>, </em><em>optional</em>) – Initial values for theta parameters. These should be roughly the scale length in the y &amp; x directions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Table with evaluated Gaussian process curve and errors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Wraps internal module-level function in order to circumvent multiprocessing module limitations in dealing with
objects when parallelising.</p>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.best_coeffs">
<code class="descname">best_coeffs</code><span class="sig-paren">(</span><em>vals</em>, <em>tol=0.98</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.best_coeffs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.best_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the minimum number of PCA components required to adequately describe the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vals</strong> (<em>list-like</em>) – List of eigenvalues (ordered largest to smallest)</li>
<li><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – How much ‘energy’ or information must be retained in the dataset.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The required number of coefficients to retain the requested amount of “information”.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.extract_GP">
<code class="descname">extract_GP</code><span class="sig-paren">(</span><em>d</em>, <em>ngp</em>, <em>xmin</em>, <em>xmax</em>, <em>initheta</em>, <em>save_output</em>, <em>output_root</em>, <em>nprocesses</em>, <em>gpalgo='george'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.extract_GP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.extract_GP" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs Gaussian process code on entire dataset. The result is stored inside the models attribute of the dataset object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>d</strong> (<em>Dataset object</em>) – Dataset</li>
<li><strong>ngp</strong> (<em>int</em>) – Number of points to evaluate Gaussian Process at</li>
<li><strong>xmin</strong> (<em>float</em>) – Minimim time to evaluate at</li>
<li><strong>xmax</strong> (<em>float</em>) – Maximum time to evaluate at</li>
<li><strong>initheta</strong> (<em>list-like</em>) – Initial values for theta parameters. These should be roughly the scale length in the y &amp; x directions.</li>
<li><strong>save_output</strong> (<em>bool</em>) – Whether or not to save the output</li>
<li><strong>output_root</strong> (<em>str</em>) – Output directory</li>
<li><strong>nprocesses</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of processors to use for parallelisation (shared memory only)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.extract_features">
<code class="descname">extract_features</code><span class="sig-paren">(</span><em>d, initheta=[500, 20], save_output='none', output_root='features', nprocesses=1, restart='none', gpalgo='george', xmin=None, xmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.extract_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a wavelet transform followed by PCA dimensionality reduction to extract wavelet coefficients as features.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>d</strong> (<em>Dataset object</em>) – Dataset</li>
<li><strong>initheta</strong> (<em>list-like</em><em>, </em><em>optional</em>) – Initial values for theta parameters. These should be roughly the scale length in the y &amp; x directions.</li>
<li><strong>save_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to save the output</li>
<li><strong>output_root</strong> (<em>str</em><em>, </em><em>optional</em>) – Output directory</li>
<li><strong>nprocesses</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of processors to use for parallelisation (shared memory only)</li>
<li><strong>restart</strong> (<em>str</em><em>, </em><em>optional</em>) – Either ‘none’ to start from scratch, ‘gp’ to restart from saved Gaussian processes, or ‘wavelet’ to
restart from saved wavelet decompositions (will look in output_root for the previously saved outputs).</li>
<li><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to take the logarithm of the final PCA components. Recommended setting is False (legacy code).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Table of features (first column object names, the rest are the PCA coefficient values)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.extract_pca">
<code class="descname">extract_pca</code><span class="sig-paren">(</span><em>object_names</em>, <em>wavout</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.extract_pca"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.extract_pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensionality reduction of wavelet coefficients using PCA.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>object_names</strong> (<em>list-like</em>) – Object names corresponding to each row of the wavelet coefficient array.</li>
<li><strong>wavout</strong> (<em>array</em>) – Wavelet coefficient array, each row corresponds to an object, each column is a coefficient.</li>
<li><strong>log</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Astropy table containing PCA features.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.extract_wavelets">
<code class="descname">extract_wavelets</code><span class="sig-paren">(</span><em>d</em>, <em>wav</em>, <em>mlev</em>, <em>nprocesses</em>, <em>save_output</em>, <em>output_root</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.extract_wavelets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.extract_wavelets" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform wavelet decomposition on all objects in dataset. Output is stored as astropy table for each object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>d</strong> (<em>Dataset object</em>) – Dataset</li>
<li><strong>wav</strong> (<em>str</em><em> or </em><em>swt.Wavelet object</em>) – Which wavelet family to use</li>
<li><strong>mlev</strong> (<em>int</em>) – Max depth</li>
<li><strong>nprocesses</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of processors to use for parallelisation (shared memory only)</li>
<li><strong>save_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to save the output</li>
<li><strong>output_root</strong> (<em>str</em><em>, </em><em>optional</em>) – Output directory</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>wavout</strong> (<em>array</em>) – A numpy array of the wavelet coefficients where each row is an object and each column a different coefficient</li>
<li><strong>wavout_err</strong> (<em>array</em>) – A numpy array storing the (assuming Gaussian) error on each coefficient.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.fit_sn">
<code class="descname">fit_sn</code><span class="sig-paren">(</span><em>lc</em>, <em>comps</em>, <em>vec</em>, <em>mn</em>, <em>xmin</em>, <em>xmax</em>, <em>filter_set</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.fit_sn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.fit_sn" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a single object using previously run PCA components. Performs the full inverse wavelet transform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lc</strong> (<em>astropy.table.Table</em>) – Light curve</li>
<li><strong>comps</strong> (<em>astropy.table.Table</em>) – The PCA coefficients for each object (i.e. the astropy table of wavelet features from by extract_features).</li>
<li><strong>vec</strong> (<em>array-like</em>) – PCA component vectors as array (each column is a vector, ordered from most to least significant)</li>
<li><strong>mn</strong> (<em>array-like</em>) – Mean vector</li>
<li><strong>xmin</strong> (<em>float</em>) – The minimum on the x axis (as defined for the original GP decomposition)</li>
<li><strong>xmax</strong> (<em>float</em>) – The maximum on the x axis (as defined for the original GP decomposition)</li>
<li><strong>filter_set</strong> (<em>list-like</em>) – The full set of filters of the original dataset</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fitted light curve</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.iswt">
<code class="descname">iswt</code><span class="sig-paren">(</span><em>coefficients</em>, <em>wavelet</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.iswt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.iswt" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs inverse wavelet transform.
M. G. Marino to complement pyWavelets’ swt.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coefficients</strong> (<em>array</em>) – approx and detail coefficients, arranged in level value
exactly as output from swt:
e.g. [(cA1, cD1), (cA2, cD2), …, (cAn, cDn)]</li>
<li><strong>wavelet</strong> (<em>str</em><em> or </em><em>swt.Wavelet</em>) – Either the name of a wavelet or a Wavelet object</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The inverse transformed array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.pca">
<code class="descname">pca</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.pca"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs PCA decomposition of a feature array X.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>array</em>) – Array of features to perform PCA on.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>vals</strong> (<em>list-like</em>) – Ordered array of eigenvalues</li>
<li><strong>vec</strong> (<em>array</em>) – Ordered array of eigenvectors, where each column is an eigenvector.</li>
<li><strong>mn</strong> (<em>array</em>) – The mean of the dataset, which is subtracted before PCA is performed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Although SVD is considerably more efficient than eigh, it seems more numerically unstable and results in many more components
being required to adequately describe the dataset, at least for the wavelet feature sets considered.</p>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.project_pca">
<code class="descname">project_pca</code><span class="sig-paren">(</span><em>X</em>, <em>eig_vec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.project_pca"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.project_pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Project a vector onto a PCA axis (i.e. transform data to PCA space).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>array</em>) – Vector of original data (for one object).</li>
<li><strong>eig_vec</strong> (<em>array</em>) – Array of eigenvectors, first column most significant.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Coefficients of eigen vectors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.restart_from_gp">
<code class="descname">restart_from_gp</code><span class="sig-paren">(</span><em>d</em>, <em>output_root</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.restart_from_gp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.restart_from_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows the restarted of the feature extraction process from previously saved Gaussian Process curves.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>d</strong> (<em>Dataset object</em>) – The same dataset (object) on which the previous GP analysis was performed.</li>
<li><strong>output_root</strong> (<em>str</em>) – Location of GP objects</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.restart_from_wavelets">
<code class="descname">restart_from_wavelets</code><span class="sig-paren">(</span><em>d</em>, <em>output_root</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.restart_from_wavelets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.restart_from_wavelets" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows the restarted of the feature extraction process from previously saved wavelet decompositions. This
allows you to quickly try different dimensionality reduction (e.g. PCA) algorithms on the wavelets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>d</strong> (<em>Dataset object</em>) – The same dataset (object) on which the previous wavelet analysis was performed.</li>
<li><strong>output_root</strong> (<em>str</em>) – Location of previously decomposed wavelet coefficients</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>wavout</strong> (<em>array</em>) – A numpy array of the wavelet coefficients where each row is an object and each column a different coefficient</li>
<li><strong>wavout_err</strong> (<em>array</em>) – A similar numpy array storing the (assuming Gaussian) error on each coefficient.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="snmachine.snfeatures.WaveletFeatures.wavelet_decomp">
<code class="descname">wavelet_decomp</code><span class="sig-paren">(</span><em>lc</em>, <em>wav</em>, <em>mlev</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#WaveletFeatures.wavelet_decomp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.WaveletFeatures.wavelet_decomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a wavelet decomposition on a single light curve.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lc</strong> (<em>astropy.table.Table</em>) – Light curve</li>
<li><strong>wav</strong> (<em>str</em><em> or </em><em>swt.Wavelet object</em>) – Which wavelet family to use</li>
<li><strong>mlev</strong> (<em>int</em>) – Max depth</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Decomposed coefficients in each filter.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">astropy.table.Table</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="snmachine.snfeatures.get_MAP">
<code class="descclassname">snmachine.snfeatures.</code><code class="descname">get_MAP</code><span class="sig-paren">(</span><em>chain_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#get_MAP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.get_MAP" title="Permalink to this definition">¶</a></dt>
<dd><p>Read maximum posterior parameters from a stats file of multinest.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chain_name</strong> (<em>str</em>) – Root for the chain files</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Best-fitting parameters</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list-like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="snmachine.snfeatures.output_time">
<code class="descclassname">snmachine.snfeatures.</code><code class="descname">output_time</code><span class="sig-paren">(</span><em>tm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/snmachine/snfeatures.html#output_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#snmachine.snfeatures.output_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to output the time nicely formatted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tm</strong> (<em>Input time in seconds.</em>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tsne_plot.html" class="btn btn-neutral float-right" title="tsne_plot" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sndata.html" class="btn btn-neutral" title="sndata" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Michelle Lochner, Robert Schuhmann, Jason McEwen, Hiranya Peiris, Rahul Biswas, Ofer Lahav, Johnny Holland, Max Winter.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>